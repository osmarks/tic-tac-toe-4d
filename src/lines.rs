use std::convert::TryInto;
use std::iter::FromIterator;
use fixedbitset::FixedBitSet;

pub const LINES: [[u8; 4]; 520] = [[11, 91, 171, 251], [195, 211, 227, 243], [13, 73, 133, 193], [40, 104, 168, 232], [227, 231, 235, 239], [15, 91, 167, 243], [48, 52, 56, 60], [55, 119, 183, 247], [35, 99, 163, 227], [96, 101, 106, 111], [236, 237, 238, 239], [51, 55, 59, 63], [99, 103, 107, 111], [96, 100, 104, 108], [8, 9, 10, 11], [208, 212, 216, 220], [128, 132, 136, 140], [47, 110, 173, 236], [130, 146, 162, 178], [24, 89, 154, 219], [65, 81, 97, 113], [35, 98, 161, 224], [44, 108, 172, 236], [46, 110, 174, 238], [64, 65, 66, 67], [71, 87, 103, 119], [0, 20, 40, 60], [199, 214, 229, 244], [51, 98, 145, 192], [60, 104, 148, 192], [16, 81, 146, 211], [12, 24, 36, 48], [108, 109, 110, 111], [57, 105, 153, 201], [60, 124, 188, 252], [104, 105, 106, 107], [32, 100, 168, 236], [51, 99, 147, 195], [83, 86, 89, 92], [21, 85, 149, 213], [55, 118, 181, 244], [184, 185, 186, 187], [208, 213, 218, 223], [3, 70, 137, 204], [5, 69, 133, 197], [73, 89, 105, 121], [207, 222, 237, 252], [1, 69, 137, 205], [58, 122, 186, 250], [67, 87, 107, 127], [204, 221, 238, 255], [15, 94, 173, 252], [60, 120, 180, 240], [140, 156, 172, 188], [43, 106, 169, 232], [192, 197, 202, 207], [59, 122, 185, 248], [8, 73, 138, 203], [161, 165, 169, 173], [59, 106, 153, 200], [180, 181, 182, 183], [5, 85, 165, 245], [17, 85, 153, 221], [49, 53, 57, 61], [47, 111, 175, 239], [1, 81, 161, 241], [248, 249, 250, 251], [45, 109, 173, 237], [63, 127, 191, 255], [66, 70, 74, 78], [68, 85, 102, 119], [67, 70, 73, 76], [71, 86, 101, 116], [60, 108, 156, 204], [30, 90, 150, 210], [54, 102, 150, 198], [13, 89, 165, 241], [98, 102, 106, 110], [15, 79, 143, 207], [163, 167, 171, 175], [13, 77, 141, 205], [26, 90, 154, 218], [32, 36, 40, 44], [129, 133, 137, 141], [0, 81, 162, 243], [143, 155, 167, 179], [63, 122, 181, 240], [19, 22, 25, 28], [51, 103, 155, 207], [63, 126, 189, 252], [10, 90, 170, 250], [96, 97, 98, 99], [100, 101, 102, 103], [196, 197, 198, 199], [48, 100, 152, 204], [64, 85, 106, 127], [208, 209, 210, 211], [13, 29, 45, 61], [12, 76, 140, 204], [80, 81, 82, 83], [27, 90, 153, 216], [78, 90, 102, 114], [2, 70, 138, 206], [78, 94, 110, 126], [79, 91, 103, 115], [19, 82, 145, 208], [188, 189, 190, 191], [2, 66, 130, 194], [3, 82, 161, 240], [1, 21, 41, 61], [143, 158, 173, 188], [141, 153, 165, 177], [120, 121, 122, 123], [132, 149, 166, 183], [198, 214, 230, 246], [48, 116, 184, 252], [195, 199, 203, 207], [144, 148, 152, 156], [0, 1, 2, 3], [4, 84, 164, 244], [138, 154, 170, 186], [76, 88, 100, 112], [9, 25, 41, 57], [68, 69, 70, 71], [12, 92, 172, 252], [31, 90, 149, 208], [160, 161, 162, 163], [7, 71, 135, 199], [67, 83, 99, 115], [12, 93, 174, 255], [207, 218, 229, 240], [129, 145, 161, 177], [243, 247, 251, 255], [129, 149, 169, 189], [44, 45, 46, 47], [240, 241, 242, 243], [76, 77, 78, 79], [128, 145, 162, 179], [192, 212, 232, 252], [47, 107, 167, 227], [6, 70, 134, 198], [224, 229, 234, 239], [56, 57, 58, 59], [15, 74, 133, 192], [75, 90, 105, 120], [211, 214, 217, 220], [63, 110, 157, 204], [23, 87, 151, 215], [28, 29, 30, 31], [37, 101, 165, 229], [207, 219, 231, 243], [33, 37, 41, 45], [176, 181, 186, 191], [156, 157, 158, 159], [9, 89, 169, 249], [11, 26, 41, 56], [140, 152, 164, 176], [176, 180, 184, 188], [241, 245, 249, 253], [46, 106, 166, 226], [3, 67, 131, 195], [7, 22, 37, 52], [131, 135, 139, 143], [179, 182, 185, 188], [28, 92, 156, 220], [44, 105, 166, 227], [56, 121, 186, 251], [2, 6, 10, 14], [68, 84, 100, 116], [40, 105, 170, 235], [193, 213, 233, 253], [200, 201, 202, 203], [48, 53, 58, 63], [227, 230, 233, 236], [59, 107, 155, 203], [132, 133, 134, 135], [66, 86, 106, 126], [4, 69, 134, 199], [28, 93, 158, 223], [194, 198, 202, 206], [63, 106, 149, 192], [44, 104, 164, 224], [210, 214, 218, 222], [4, 68, 132, 196], [52, 101, 150, 199], [45, 105, 165, 225], [192, 196, 200, 204], [60, 121, 182, 243], [131, 147, 163, 179], [131, 151, 171, 191], [2, 86, 170, 254], [131, 150, 169, 188], [112, 117, 122, 127], [97, 101, 105, 109], [35, 103, 171, 239], [29, 89, 149, 209], [177, 181, 185, 189], [57, 121, 185, 249], [14, 26, 38, 50], [72, 88, 104, 120], [196, 213, 230, 247], [143, 154, 165, 176], [34, 102, 170, 238], [11, 75, 139, 203], [74, 90, 106, 122], [4, 21, 38, 55], [204, 216, 228, 240], [15, 30, 45, 60], [51, 114, 177, 240], [16, 80, 144, 208], [41, 105, 169, 233], [63, 111, 159, 207], [14, 30, 46, 62], [7, 87, 167, 247], [51, 118, 185, 252], [12, 72, 132, 192], [29, 93, 157, 221], [8, 24, 40, 56], [99, 102, 105, 108], [130, 150, 170, 190], [72, 73, 74, 75], [20, 85, 150, 215], [7, 70, 133, 196], [3, 83, 163, 243], [66, 82, 98, 114], [38, 102, 166, 230], [61, 105, 149, 193], [67, 86, 105, 124], [51, 54, 57, 60], [205, 221, 237, 253], [0, 80, 160, 240], [142, 154, 166, 178], [0, 16, 32, 48], [192, 209, 226, 243], [240, 245, 250, 255], [52, 116, 180, 244], [64, 80, 96, 112], [49, 101, 153, 205], [194, 214, 234, 254], [12, 13, 14, 15], [206, 222, 238, 254], [62, 126, 190, 254], [3, 18, 33, 48], [8, 25, 42, 59], [4, 85, 166, 247], [16, 21, 26, 31], [64, 69, 74, 79], [3, 7, 11, 15], [32, 37, 42, 47], [112, 113, 114, 115], [3, 87, 171, 255], [14, 94, 174, 254], [12, 77, 142, 207], [112, 116, 120, 124], [160, 165, 170, 175], [12, 29, 46, 63], [72, 89, 106, 123], [70, 86, 102, 118], [136, 153, 170, 187], [62, 110, 158, 206], [11, 90, 169, 248], [64, 81, 98, 115], [203, 219, 235, 251], [195, 198, 201, 204], [67, 71, 75, 79], [152, 153, 154, 155], [18, 82, 146, 210], [142, 158, 174, 190], [50, 118, 186, 254], [69, 85, 101, 117], [205, 217, 229, 241], [67, 82, 97, 112], [51, 102, 153, 204], [52, 53, 54, 55], [216, 217, 218, 219], [13, 25, 37, 49], [48, 49, 50, 51], [128, 129, 130, 131], [50, 54, 58, 62], [50, 98, 146, 194], [144, 149, 154, 159], [40, 41, 42, 43], [6, 22, 38, 54], [61, 125, 189, 253], [172, 173, 174, 175], [60, 109, 158, 207], [139, 155, 171, 187], [48, 113, 178, 243], [12, 73, 134, 195], [7, 23, 39, 55], [194, 210, 226, 242], [209, 213, 217, 221], [56, 105, 154, 203], [51, 119, 187, 255], [34, 98, 162, 226], [0, 84, 168, 252], [14, 74, 134, 194], [244, 245, 246, 247], [62, 122, 182, 242], [0, 64, 128, 192], [12, 25, 38, 51], [31, 95, 159, 223], [131, 146, 161, 176], [168, 169, 170, 171], [128, 133, 138, 143], [19, 23, 27, 31], [141, 157, 173, 189], [55, 102, 149, 196], [163, 166, 169, 172], [80, 85, 90, 95], [62, 106, 150, 194], [135, 150, 165, 180], [24, 25, 26, 27], [76, 89, 102, 115], [207, 223, 239, 255], [7, 86, 165, 244], [3, 22, 41, 60], [77, 93, 109, 125], [131, 134, 137, 140], [19, 87, 155, 223], [18, 86, 154, 222], [212, 213, 214, 215], [23, 86, 149, 212], [35, 39, 43, 47], [200, 216, 232, 248], [56, 120, 184, 248], [53, 117, 181, 245], [4, 20, 36, 52], [79, 90, 101, 112], [193, 197, 201, 205], [179, 183, 187, 191], [92, 93, 94, 95], [160, 164, 168, 172], [16, 17, 18, 19], [16, 84, 152, 220], [228, 229, 230, 231], [84, 85, 86, 87], [115, 118, 121, 124], [148, 149, 150, 151], [206, 218, 230, 242], [128, 144, 160, 176], [56, 104, 152, 200], [61, 109, 157, 205], [137, 153, 169, 185], [0, 4, 8, 12], [8, 89, 170, 251], [8, 88, 168, 248], [134, 150, 166, 182], [63, 107, 151, 195], [60, 61, 62, 63], [88, 89, 90, 91], [193, 209, 225, 241], [201, 217, 233, 249], [0, 21, 42, 63], [1, 17, 33, 49], [132, 148, 164, 180], [192, 208, 224, 240], [204, 220, 236, 252], [147, 150, 153, 156], [34, 38, 42, 46], [12, 88, 164, 240], [232, 233, 234, 235], [36, 101, 166, 231], [77, 89, 101, 113], [19, 83, 147, 211], [0, 68, 136, 204], [33, 97, 161, 225], [8, 72, 136, 200], [4, 5, 6, 7], [195, 214, 233, 252], [0, 5, 10, 15], [64, 68, 72, 76], [252, 253, 254, 255], [199, 215, 231, 247], [28, 88, 148, 208], [15, 90, 165, 240], [13, 93, 173, 253], [115, 119, 123, 127], [44, 109, 174, 239], [136, 152, 168, 184], [9, 73, 137, 201], [60, 125, 190, 255], [130, 134, 138, 142], [145, 149, 153, 157], [51, 115, 179, 243], [15, 27, 39, 51], [203, 218, 233, 248], [24, 88, 152, 216], [48, 112, 176, 240], [27, 91, 155, 219], [59, 123, 187, 251], [226, 230, 234, 238], [28, 89, 150, 211], [53, 101, 149, 197], [0, 17, 34, 51], [81, 85, 89, 93], [52, 100, 148, 196], [64, 84, 104, 124], [139, 154, 169, 184], [178, 182, 186, 190], [240, 244, 248, 252], [11, 74, 137, 200], [225, 229, 233, 237], [83, 87, 91, 95], [50, 102, 154, 206], [14, 78, 142, 206], [143, 159, 175, 191], [20, 84, 148, 212], [162, 166, 170, 174], [140, 141, 142, 143], [65, 85, 105, 125], [14, 90, 166, 242], [5, 21, 37, 53], [135, 151, 167, 183], [2, 18, 34, 50], [49, 97, 145, 193], [195, 210, 225, 240], [32, 97, 162, 227], [49, 117, 185, 253], [1, 65, 129, 193], [3, 23, 43, 63], [65, 69, 73, 77], [192, 213, 234, 255], [0, 65, 130, 195], [33, 101, 169, 237], [17, 81, 145, 209], [79, 94, 109, 124], [15, 95, 175, 255], [0, 69, 138, 207], [3, 71, 139, 207], [16, 85, 154, 223], [50, 114, 178, 242], [61, 121, 181, 241], [164, 165, 166, 167], [30, 94, 158, 222], [18, 22, 26, 30], [211, 215, 219, 223], [43, 107, 171, 235], [75, 91, 107, 123], [16, 20, 24, 28], [113, 117, 121, 125], [116, 117, 118, 119], [47, 106, 165, 224], [82, 86, 90, 94], [146, 150, 154, 158], [60, 105, 150, 195], [196, 212, 228, 244], [32, 33, 34, 35], [32, 96, 160, 224], [0, 85, 170, 255], [192, 193, 194, 195], [243, 246, 249, 252], [133, 149, 165, 181], [128, 148, 168, 188], [1, 5, 9, 13], [224, 225, 226, 227], [204, 217, 230, 243], [1, 85, 169, 253], [12, 28, 44, 60], [52, 117, 182, 247], [48, 96, 144, 192], [20, 21, 22, 23], [76, 92, 108, 124], [124, 125, 126, 127], [10, 74, 138, 202], [49, 113, 177, 241], [63, 123, 183, 243], [140, 153, 166, 179], [31, 91, 151, 211], [12, 89, 166, 243], [76, 93, 110, 127], [39, 103, 167, 231], [36, 100, 164, 228], [48, 117, 186, 255], [2, 22, 42, 62], [147, 151, 155, 159], [176, 177, 178, 179], [35, 38, 41, 44], [55, 103, 151, 199], [32, 101, 170, 239], [25, 89, 153, 217], [3, 86, 169, 252], [144, 145, 146, 147], [54, 118, 182, 246], [224, 228, 232, 236], [220, 221, 222, 223], [204, 205, 206, 207], [15, 31, 47, 63], [11, 27, 43, 59], [36, 37, 38, 39], [6, 86, 166, 246], [48, 97, 146, 195], [195, 215, 235, 255], [3, 6, 9, 12], [31, 94, 157, 220], [19, 86, 153, 220], [136, 137, 138, 139], [79, 95, 111, 127], [35, 102, 169, 236], [202, 218, 234, 250], [114, 118, 122, 126], [22, 86, 150, 214], [17, 21, 25, 29], [2, 82, 162, 242], [128, 149, 170, 191], [15, 26, 37, 48], [200, 217, 234, 251], [3, 19, 35, 51], [80, 84, 88, 92], [15, 78, 141, 204], [10, 26, 42, 58], [48, 101, 154, 207], [3, 66, 129, 192], [39, 102, 165, 228], [242, 246, 250, 254], [140, 157, 174, 191], [58, 106, 154, 202], [15, 75, 135, 195], [42, 106, 170, 234], [197, 213, 229, 245]];

lazy_static::lazy_static! {
    pub static ref LINE_MAP: [Vec<usize>; 256] = (0..=255).map(|slot| {
        let mut relevant_lines = Vec::new();
        for (i, line) in LINES.iter().enumerate() {
            for pos in line {
                if *pos == slot {
                    relevant_lines.push(i)
                }
            }
        }
        relevant_lines
    }).collect::<Vec<Vec<usize>>>().try_into().unwrap();
    pub static ref LINE_BITSETS: [FixedBitSet; 520] = LINES.iter().map(|line| FixedBitSet::from_iter(line.iter().map(|x| *x as usize))).collect::<Vec<FixedBitSet>>().try_into().unwrap();
}